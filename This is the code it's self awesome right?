-- Credits to J GitHub https://github.com/lilgeek/Sword-Simulator-3d-ModelExploit/new/main

local Gui = Instance.new("ScreenGui", game:GetService("CoreGui"))
Gui.Name = "3d Model Maker"
Gui.ResetOnSpawn = false

local frame = Instance.new("Frame")
frame.Name = "DraggableGUI"
frame.Size = UDim2.new(0.15, 0, 0.2, 0)
frame.Position = UDim2.new(0.5, -frame.AbsoluteSize.X/2, 0.5, -frame.AbsoluteSize.Y/2)
frame.BackgroundTransparency = 0.5
frame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
frame.BorderColor3 = Color3.fromRGB(255, 255, 255)
frame.BorderSizePixel = 2
frame.Draggable = true
frame.Active = true
frame.Visible = true
frame.Parent = Gui

local exitButton = Instance.new("TextButton")
exitButton.Name = "ExitButton"
exitButton.Size = UDim2.new(0, 20, 0, 20)
exitButton.Position = UDim2.new(0, 5, 0, 5)
exitButton.Text = "X"
exitButton.TextColor3 = Color3.fromRGB(255, 255, 255)
exitButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
exitButton.BorderSizePixel = 0
exitButton.Parent = frame

local textField = Instance.new("TextBox")
textField.Name = "TextInput"
textField.Size = UDim2.new(0.8, 0, 0.3, 0)
textField.Position = UDim2.new(0.1, 0, 0.3, 0)
textField.TextColor3 = Color3.fromRGB(255, 255, 255)
textField.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
textField.BorderSizePixel = 0
textField.Text = "To import 3d model get text from the 3d model you want by opening it with note pad copy and paste the text here"
textField.Parent = frame
textField.TextScaled = true



local SizeLab = Instance.new("TextBox")
SizeLab.Name = "TextInput"
SizeLab.Size = UDim2.new(0.6, 0, 0.1, 0)
SizeLab.Position = UDim2.new(0.2, 0, 0.15, 0)
SizeLab.TextColor3 = Color3.fromRGB(255, 255, 255)
SizeLab.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
SizeLab.BorderSizePixel = 0
SizeLab.Text = "Size"
SizeLab.Parent = frame
SizeLab.TextScaled = true


local storeButton = Instance.new("TextButton")
storeButton.Name = "StoreButton"
storeButton.Size = UDim2.new(0.5, 0, 0.2, 0)
storeButton.Position = UDim2.new(0.25, 0, 0.7, 0)
storeButton.Text = "Make 3d Model"
storeButton.TextScaled = true
storeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
storeButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
storeButton.BorderSizePixel = 0
storeButton.Parent = frame
local function updateGui()
    local screenGui = Gui.AbsoluteSize
    frame.Position = UDim2.new(0.5, -frame.AbsoluteSize.X/2, 0.5, -frame.AbsoluteSize.Y/2)
end


-- Create the "Mesh" button
local meshButton = Instance.new("TextButton")
meshButton.Name = "MeshButton"
meshButton.Size = UDim2.new(0.2, 0, 0.1, 0)
meshButton.Position = UDim2.new(0.75, -5, 0, 5)
meshButton.Text = "NoMesh"
meshButton.TextColor3 = Color3.fromRGB(255, 255, 255)
meshButton.BackgroundColor3 = Color3.fromRGB(0, 0, 255)
meshButton.BorderSizePixel = 0
meshButton.TextScaled = true
meshButton.Parent = frame

-- Create the "Face Player" button
local facePlayerButton = Instance.new("TextButton")
facePlayerButton.Name = "FacePlayerButton"
facePlayerButton.Size = UDim2.new(0.2, 0, 0.1, 0)
facePlayerButton.Position = UDim2.new(0.5, 5, 0, 5)
facePlayerButton.Text = "FacePlayer"
facePlayerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
facePlayerButton.BackgroundColor3 = Color3.fromRGB(0, 0, 255)
facePlayerButton.BorderSizePixel = 0
facePlayerButton.Parent = frame
facePlayerButton.TextScaled = true
Gui:GetPropertyChangedSignal("AbsoluteSize"):Connect(updateGui)

exitButton.MouseButton1Click:Connect(function()
    Gui:Destroy()
end)
local Mesh = 1
local LookAtPlay = 0
meshButton.MouseButton1Click:Connect(function()
	if meshButton.BackgroundColor3 == Color3.fromRGB(0, 0, 255) then
		meshButton.BackgroundColor3 = Color3.fromRGB(0, 0, 100)
		Mesh = 0
	else
		meshButton.BackgroundColor3 = Color3.fromRGB(0, 0, 255)
		Mesh = 1
	end
end)
facePlayerButton.MouseButton1Click:Connect(function()
	if facePlayerButton.BackgroundColor3 == Color3.fromRGB(0, 0, 255) then
		facePlayerButton.BackgroundColor3 = Color3.fromRGB(0, 0, 100)
		LookAtPlay = 1
	else
		facePlayerButton.BackgroundColor3 = Color3.fromRGB(0, 0, 255)
		LookAtPlay = 0
	end
end)
local eaaaa = 0
storeButton.MouseButton1Click:Connect(function()
	if eaaaa == 0 then
		local text = textField.Text
		eaaaa = 1


		local StGui = Instance.new("ScreenGui", game.Players.LocalPlayer.PlayerGui)
		local Frame = Instance.new("Frame", StGui)
		-- Model you get the model .txt by opening it as a .txt and paste it in models squre brackets
		Model = text
		local Player = game.Players.LocalPlayer
		local Char = Player.Character
		local ValueConvert = ''
		local TurnNew = ''
		local Vectors = {}
		local Vector3s = {}
		local ValueNum = 0
		-- Get models vectors
		for i = 1, #Model do
			if string.sub(Model, i, i+1) == 'v ' then
				ValueNum = 0
				while true do
					if string.sub(Model, i+ValueNum, i+ValueNum) ~= '\n' then
						ValueNum = ValueNum + 1
					else
						Vectors = {}
						break
					end
				end
				TurnNew = string.sub(Model, i+2, i+ValueNum-1)
				for ip = 1, #TurnNew do
					if string.sub(TurnNew, ip, ip) == ' ' or ip == #TurnNew then
						table.insert(Vectors, ValueConvert)
						ValueConvert = ''
					else
						ValueConvert = ValueConvert .. string.sub(TurnNew, ip, ip)
					end
				end
				table.insert(Vector3s, Vector3.new(tonumber(Vectors[1]), tonumber(Vectors[2]), tonumber(Vectors[3])))
			end
		end


		local Backpack = Player.Backpack
		local Num = 0
		local SwordAm = #Vector3s
		-- Loop until you have enought swords to make the model
		while true do
			Num = 0
			if Char.Humanoid.Health == 0 then
				break
			end
			for i, v in pairs(Char:GetChildren()) do
				if v:IsA('Tool') then
					Num = Num + 1
				end
			end
			if #Backpack:GetChildren() + Num >= SwordAm then
				break
			end
			wait(0.2)
			for i, v in pairs(Backpack:GetChildren()) do
				v.Parent = Char
			end
			local event = game:GetService("Workspace").load.RemoteEvent
			event:FireServer()
		end

		-- Put tools in backpack
		for i, v in pairs(Char:GetChildren()) do
			if v:IsA('Tool') then
				v.Parent = Player.Backpack
			end
		end
		local Item = nil
		local Target = nil
		local lookVector = nil
		local x = nil
		local y = nil
		local z = nil
		local CharOldC = Char.HumanoidRootPart.CFrame
		Char.HumanoidRootPart.CFrame = CFrame.new(0, 0, 0)
		-- Make model
		for i, v in pairs(Player.Backpack:GetChildren()) do
			if i > SwordAm then
				break
			end
			v.Parent = Char
			if v.Handle:FindFirstChildWhichIsA('ParticleEmitter') then
				v.Handle:FindFirstChildWhichIsA('ParticleEmitter'):Destroy()
			end
			local StringNumSize = string.gsub(SizeLab.Text, "%D", "")
			local Size = tonumber(StringNumSize)
			v.Handle.Position = Vector3s[i]*1 + Char.HumanoidRootPart.Position
			pcall(function()
				v.Handle.Position = Vector3s[i]*Size + Char.HumanoidRootPart.Position
			end)
			Item = v.Handle
			Target = game.Players.LocalPlayer.Character.HumanoidRootPart
			if LookAtPlay == 0 then
				lookVector = (Target.Position - Item.Position).Unit
				x = math.atan2(-lookVector.Y, math.sqrt(lookVector.X^2 + lookVector.Z^2))
				y = math.atan2(lookVector.X, lookVector.Z)
				z = 0
				Item.Orientation = Vector3.new(90, math.deg(y), 0)
			else
				lookVector = (Target.Position - Item.Position).Unit
				x = math.atan2(-lookVector.Y, math.sqrt(lookVector.X^2 + lookVector.Z^2))
				y = math.atan2(lookVector.X, lookVector.Z)
				z = 0
				Item.Orientation = Vector3.new(math.deg(x), math.deg(y), math.deg(z))
			end
			if Mesh == 0 then
				if Item:FindFirstChildWhichIsA("SpecialMesh") then
					Item:FindFirstChildWhichIsA("SpecialMesh"):Destroy()
				end
			end
		end
		game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CharOldC
		eaaaa = 0
	end
end)
